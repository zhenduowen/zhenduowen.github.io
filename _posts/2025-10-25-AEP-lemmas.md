---
title: A few lemmas related to AEP
description: An introduction of a few lammas commonly used in the proof of Shannon multiuser theory. These lemmas relates to the concept of typical sets, which are sequences that have a probability close to the asymptotic average, as defined by the Asymptotic Equipartition Property (AEP).
date: 2025-10-25
author: Zhenduo
categories: [Information Theory, Asymptotic Equipartition Property]
tags: [Information Theory, Asymptotic Equipartition Property, Method of Types, Typical Set, The packing lemma, The covering lemma, The blowing up lemma]
published: true
---

Two information theory textbooks for reference:



## Asymptotic Equipartition Property (AEP)

Let $X_1, X_2, \ldots, X_n$ be a sequence of independent and identically distributed (i.i.d.) random variables drawn from a probability mass function $p(x)$.

The AEP states that the quantity 

$$
- \frac{1}{n} \log p(X_1, X_2, \ldots, X_n)
$$

converges in probability to the entropy $H(X)$ as $n \to \infty$:

$$
\lim_{n \to \infty} P\left( \Big \| -\frac{1}{n} \log p(X_1, \ldots, X_n) - H(X)\Big \| < \epsilon  \right) = 1
$$

for any $\epsilon > 0$, which is true by the weak law of large numbers.


The AEP leads directly to the concept of the typical set, a collection of sequences whose properties are "typical" of the source $X$. 

**Definition. (Typical set)** 

The typical set $A^{(n)}$ is defined as:

$$
A^{(n)}_\epsilon = \Big \lbrace (x_1, x_2, \ldots, x_n) \in \mathcal{X}^n :  \Big \| -\frac{1}{n} \log p(X_1, \ldots, X_n) - H(X)\Big \| < \epsilon  \Big \rbrace
$$

This definition is equivalent to:

$$
A^{(n)}_\epsilon =  \Big \lbrace (x_1, x_2, \ldots, x_n) \in \mathcal{X}^n : 2^{-n(H(X) + \epsilon)} < p(x_1, \ldots, x_n) < 2^{-n(H(X) - \epsilon)} \Big \rbrace
$$

&nbsp;<span style="float: right;">■</span>

**Properties of the typical set**

The AEP implies three key properties of the typical set for sufficiently large $n$:

1. **High probability:** To a probability that a randomly generated sequence belongs to the typical set is close to 1. 
   $$ P(A^{(n)}_\epsilon) > 1 - \epsilon $$

2. **Approximate equiprobability:** All sequences in the typical set are approximately equally likely. Their probabilities are all close to $2^{-nH(X)}$.

3. **Size:** The number of sequences in the typical set is approximately $2^{nH(X)}$, we have 
   $$ (1 - \epsilon) 2^{n(H(X) - \epsilon)} \leq \|A^{(n)}\| \leq 2^{n(H(X) + \epsilon)} $$

The definition of joint typical sequences is likewise, only using $P_{XY}$.

## Set up

Consider the output of a discrete memoryless channel (DMC), where $X$ is the input, and $Y$ is the output. Let $\mathcal{C} = \lbrace X_m^{(n)} \rbrace_{m=1}^M$ be a random codebook, where each $X_m^{(n)}$ is drawn i.i.d. according to $P_X$.


## The packing lemma

Let $R$ be the rate at source. Fix $p(x)$ and channel $$p(y|x)$$. Now according to $p(x)$, construct $2^{nR}$ codewords, i.i.d with length $n$, 
$$X^{(n)}_m \sim \prod_{i=1}^n p(x_i)$$. Let $X_1^{(n)}$ be our message and $\tilde Y^{(n)}$ be the output of the channel. Observe that

$$
R < I(X,Y) \implies 2^{nR} \cdot \frac{2^{nH(Y|X)}}{2^{n H(Y)}} \rightarrow 0 \text{ as } n \rightarrow \infty.
$$

**Theorem. (Simplified packing lemma)**

If $X^{(n)}_m$ and $\tilde Y^{(n)}$ are independent and uniformly chosen, then the probability that $X^{(n)}_m, m \in [1, \ldots, 2^{nR}]$ and $\tilde Y^{(n)}$ are jointly typical goes to zero if $R < I(X,Y)$.

&nbsp;<span style="float: right;">■</span>


## The covering lemma


**Theorem. (Covering lemma)**

If the rate $R > I(X; Y)$, then for a typical output sequence $Y^{(n)}$ generated by the channel, the probability that there exists at least one codeword $X_m^{(n)}$ such that the pair $(X_m^n, Y^n)$ is jointly typical approaches one as $n \rightarrow \infty,$

$$
\lim_{n \to \infty} P \left\{ \exists m \in \{1, \ldots, M\} : (X_m^{(n)}, Y^{(n)}) \in \mathcal{T} \right\} = 1.
$$

&nbsp;<span style="float: right;">■</span>

## The blowing up lemma

> K. Marton, "A simple proof of the blowing-up lemma (Corresp.)," in IEEE Transactions on Information Theory, vol. 32, no. 3, pp. 445-446, May 1986, doi: 10.1109/TIT.1986.1057176. keywords: {Codes;Arithmetic;Random variables;Q measurement;Presses;Hamming distances;Generators;Welding;Single photon emission computed tomography;Probabilistic logic},
>
> R. Ahlswede and I. Csiszar, "Hypothesis testing with communication constraints," in IEEE Transactions on Information Theory, vol. 32, no. 4, pp. 533-542, July 1986, doi: 10.1109/TIT.1986.1057194.
keywords: {Testing;Source coding;Random variables;Search problems;Entropy;Standards;Rate distortion theory;Prototypes;Particle measurements;Noise measurement},



The blowing-up lemma says if the probability with respect to a product measure of a set $A \subseteq \mathcal X^n$ ($\mathcal X$ is finite and $n$ is large) is not exponentially small, then its $l_n$-neighborhood has probability almost one for some $l_n = o(n)$.


**Theorem. (The blowing up lemma)**

To any finite sets $\mathcal{X}, \mathcal{Y}$ and sequence $\epsilon_n \to 0$, a sequence of positive integers $l_n$ with $l_n/n \to 0$ and a sequence $\gamma_n \rightarrow 1$ exist such that for any i.i.d. sequence of pairs of random variables $(X_i, Y_i)$ with values in $\mathcal{X}$ and $\mathcal{Y}$ and for every $n, x^n \in \mathcal{X}^n, F \subset \mathcal{Y}^n$,

$$
\Pr\left( Y^n \in F | X^n = x^n \right) \geq \exp(-n \epsilon_n)
$$

implies 

$$
\Pr \left( \Gamma^{l_n} F | X^n = x^n \right) \geq \gamma_n
$$

Here $\Gamma^l F$ denotes the Hamming distance $\ell$-neighborhood of $F$, i.e.,

$$
\Gamma^l F = \{ \overline{y}^n \in \mathcal{Y}^n : d_H(\overline{y}^n, y^n) \leq \ell \text{ for some } y^n \in F \}
$$

&nbsp;<span style="float: right;">■</span>